/**
 * WhatsApp Business Advisor skill ‚Äî Catalog, automation, broadcasts, API.
 * Owner: HeadGrowth agent.
 */
import type { LLMClient } from './callTranscription.js';
export interface WhatsAppBusinessAdvice { catalog: { setup: string[]; bestPractices: string[]; categories: string[] }; automation: { welcomeMessage: string; quickReplies: string[]; awayMessage: string; flows: string[] }; broadcasts: { segmentation: string[]; timing: string; templates: string[]; compliance: string[] }; api: { providers: string[]; useCases: string[]; pricing: string }; actionSteps: string[]; }
export interface WhatsAppBusinessOptions { businessType: string; monthlyMessages?: number; country?: string; challenges?: string; language?: string; }
const SYSTEM = 'You are a WhatsApp Business expert for LatAm SMBs. Catalog optimization, automation, broadcast strategies, API migration. Default language: Spanish.';
const FORMAT = 'Respond with JSON: { "catalog": { "setup": [string], "bestPractices": [string], "categories": [string] }, "automation": { "welcomeMessage": string, "quickReplies": [string], "awayMessage": string, "flows": [string] }, "broadcasts": { "segmentation": [string], "timing": string, "templates": [string], "compliance": [string] }, "api": { "providers": [string], "useCases": [string], "pricing": string }, "actionSteps": [string] }';
export async function adviseWhatsAppBusiness(options: WhatsAppBusinessOptions, llmClient?: LLMClient): Promise<WhatsAppBusinessAdvice> {
  if (llmClient) { const prompt = `WhatsApp Business advice for: ${options.businessType}\nCountry: ${options.country ?? 'Mexico'}\nMonthly messages: ${options.monthlyMessages ?? 'unknown'}\n${options.challenges ? `Challenges: ${options.challenges}\n` : ''}\n${FORMAT}`; const response = await llmClient.complete({ prompt, system: SYSTEM, tier: 'haiku' }); try { return JSON.parse(response.text) as WhatsAppBusinessAdvice; } catch { /* fall through */ } }
  return { catalog: { setup: ['M√°ximo 500 productos', 'Fotos cuadradas 1080x1080', 'Precio en moneda local', 'Descripci√≥n corta (max 100 chars)'], bestPractices: ['Actualizar precios semanalmente', 'Organizar por colecciones', 'Incluir variantes como productos separados'], categories: ['Productos f√≠sicos', 'Servicios', 'Men√∫ de restaurante', 'Servicios profesionales'] }, automation: { welcomeMessage: '¬°Hola! üëã Bienvenido a [Negocio]. ¬øEn qu√© te puedo ayudar?\n1Ô∏è‚É£ Ver cat√°logo\n2Ô∏è‚É£ Hacer pedido\n3Ô∏è‚É£ Soporte', quickReplies: ['Gracias por tu compra', 'Tu pedido est√° en camino', 'Horarios: L-V 9am-6pm', 'M√©todos de pago disponibles'], awayMessage: 'Estamos fuera de horario. Te respondemos ma√±ana a primera hora.', flows: ['Flujo de pedido: Saludo ‚Üí Cat√°logo ‚Üí Selecci√≥n ‚Üí Pago ‚Üí Confirmaci√≥n', 'Flujo de soporte: Problema ‚Üí Categor√≠a ‚Üí Soluci√≥n ‚Üí Seguimiento'] }, broadcasts: { segmentation: ['Clientes activos (compra <30 d√≠as)', 'Clientes inactivos (>90 d√≠as)', 'Leads nuevos (nunca compraron)', 'VIPs (>3 compras)'], timing: 'Martes a jueves, 10am-12pm o 3pm-5pm (hora local)', templates: ['Promoci√≥n semanal', 'Nuevo producto/servicio', 'Recordatorio de pago', 'Encuesta de satisfacci√≥n'], compliance: ['Solo enviar a contactos que dieron opt-in', 'Incluir opci√≥n de darse de baja', 'M√°ximo 1 broadcast por semana', 'No enviar despu√©s de 8pm'] }, api: { providers: ['360dialog', 'Twilio', 'MessageBird', 'Wati'], useCases: ['Notificaciones transaccionales', 'Chatbot con IA', 'Integraci√≥n CRM', 'Pagos por WhatsApp'], pricing: 'Conversaciones de marketing: ~$0.05-0.10 USD, Utility: ~$0.02-0.05 USD' }, actionSteps: ['Completar cat√°logo con fotos y precios', 'Configurar mensaje de bienvenida y respuestas r√°pidas', 'Segmentar contactos en 4 grupos', 'Programar primer broadcast a clientes activos'] };
}
